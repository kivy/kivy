#:kivy 1.4
#:import KivyLexer kivy.extras.highlight.KivyLexer
#:import SlideTransition kivy.uix.screenmanager.SlideTransition

[ContainerToggle@ToggleButton]:
    group: "container_toggle"
    text: ctx.text
    on_press: root.parent.parent.parent.parent.parent.parent.show_kv(*args)
    state: ctx.state if hasattr(ctx, "state") else "normal"

<Container>:
	canvas.before:
		Color:
			rgb: 0, 0, 0
		Rectangle:
			pos: self.pos
			size: self.size


<MenuButton>:
    group: "menu_toggle"
    size_hint: None, 1
    width: self.height

<Catalog>:
    language_box: language_box
    screen_manager: screen_manager
    # TODO: TABS?
    menu_select: menu_select
    menu_view: menu_view
    menu_code: menu_code
    current_view: "Welcome"
    info_label: info_lbl
    orientation: 'vertical'
    BoxLayout:
        orientation: "vertical"
        BoxLayout:
            orientation: "horizontal"
            size_hint: 1, None
            height: "44sp"
            MenuButton:
                id: menu_select
                text: "Select"
                state: "down"
                on_release:
                    self.state = "down"
                    root.screen_manager.current = "Select"
            MenuButton:
                id: menu_view
                text: "View"
                on_release: root.change_kv(*args)
                enabled: False
            MenuButton:
                id: menu_code
                text: "Code"
                on_release: root.screen_manager.current = "Code"
                enabled: False

        ScreenManager:
            id: screen_manager
            transition: SlideTransition()
            Screen:
                name: "Select"
                GridLayout:
                    size_hint: 1, 1
                    cols: 4
                    ContainerToggle:
                        text: "Welcome"
                        state: "down"
                    ContainerToggle:
                        text: "Float Layout"
                    ContainerToggle:
                        text: "Box Layout"
                    ContainerToggle:
                        text: "Anchor Layout"
                    ContainerToggle:
                        text: "Grid Layout"
                    ContainerToggle:
                        text: "Stack Layout"
                    ContainerToggle:
                        text: "Buttons"
                    ContainerToggle:
                        text: "Labels"
                    ContainerToggle:
                        text: "Booleans"
                    ContainerToggle:
                        text: "Progress Bar"
                    ContainerToggle:
                        text: "Media"
                    ContainerToggle:
                        text: "Text"
                    ContainerToggle:
                        text: "Popups"
                    ContainerToggle:
                        text: "Selectors"
                    ContainerToggle:
                        text: "File Choosers"
                    ContainerToggle:
                        text: "Scatter"
                    ContainerToggle:
                        text: "ReST"
            Screen:
                name: "Code"
                ScrollView:
                    id: kr_scroll
                    KivyRenderTextInput:
                        catalog: root
                        id: language_box
                        lexer: KivyLexer()
                        size_hint: 1, None
                        height: max( (len(self._lines)+1) * (self.line_height + self._line_spacing), kr_scroll.height)
                        font_name: "data/fonts/DroidSansMono.ttf"
                        valign: "top"
                        text: "This box will display the kivy language for whatever has been selected"
            Screen:
                name: "Welcome"
                PlaygroundContainer:
            Screen:
                name: "Float Layout"
                FloatLayoutContainer:
            Screen:
                name: "Box Layout"
                BoxLayoutContainer:
            Screen:
                name: "Anchor Layout"
                AnchorLayoutContainer:
            Screen:
                name: "Grid Layout"
                GridLayoutContainer:
            Screen:
                name: "Stack Layout"
                StackLayoutContainer:
            Screen:
                name: "Buttons"
                ButtonContainer:
            Screen:
                name: "Labels"
                LabelContainer:
            Screen:
                name: "Booleans"
                CheckBoxContainer:
            Screen:
                name: "Progress Bar"
                ProgressBarContainer:
            Screen:
                name: "Media"
                MediaContainer:
            Screen:
                name: "Text"
                TextContainer:
            Screen:
                name: "Popups"
                PopupContainer:
            Screen:
                name: "Selectors"
                SelectorsContainer:
            Screen:
                name: "File Choosers"
                FileChooserContainer:
            Screen:
                name: "Scatter"
                ScatterContainer:
            Screen:
                name: "ReST"
                RestContainer:

        FloatLayout:
            size_hint: 1, None
            height: 0
            TextInput:
                id:info_lbl
                readonly: True
                font_size: '14sp'
                background_color: (0, 0, 0, 1)
                foreground_color: (1, 1, 1, 1)
                opacity:0
                size_hint: 1, None
                text_size: self.size
                height: '150pt'
                top: 0
